# Popup Dialog Steals Focus When User is Typing

## Problem
When a firewall popup appears while the user is typing (e.g., in terminal, text editor, browser), the popup steals keyboard focus, interrupting the user's workflow. This is extremely disruptive.

## Current Behavior
- Popup appears and immediately grabs keyboard focus
- User's typing is interrupted mid-sentence
- Very annoying UX, especially during active work

## Desired Behavior
- Popup appears on screen but **doesn't steal focus**
- User can finish typing/working
- User deals with popup when ready (has 60 seconds)
- Popup stays on top but non-intrusive

## What We've Tried

### Attempt 1: Window Flags + WA_ShowWithoutActivating
```python
self.setWindowFlags(
    Qt.WindowType.WindowStaysOnTopHint |
    Qt.WindowType.FramelessWindowHint |
    Qt.WindowType.Tool  # Tool windows don't steal focus
)
self.setAttribute(Qt.WidgetAttribute.WA_ShowWithoutActivating)
```
**Result:** Still steals focus

### Attempt 2: Non-Modal with show()
Changed from `dialog.exec()` (modal/blocking) to `dialog.show()` (non-modal)
**Result:** Still steals focus

## What Works
✅ Click-away prevention (closeEvent override)
✅ 60 second timeout
✅ Stays on top
✅ Non-modal operation

## Possible Solutions to Investigate

1. **Platform-specific window hints**
   - X11: `_NET_WM_STATE_DEMANDS_ATTENTION` instead of raising window
   - Wayland: May need different approach

2. **Notification-style approach**
   - Show as system notification first
   - Click notification to open full dialog
   - Non-intrusive by design

3. **Deferred activation**
   - Show popup minimized or hidden
   - Animate in after delay
   - Use `QTimer.singleShot()` to delay any focus-grabbing

4. **Qt flags combinations**
   - Try `Qt.WindowType.ToolTip` or `Qt.WindowType.SplashScreen`
   - Experiment with `Qt.WA_X11DoNotAcceptFocus` on X11

5. **Focus policy**
   - Set `setFocusPolicy(Qt.FocusPolicy.NoFocus)` on dialog and all widgets
   - May prevent any focus grab

## Environment
- OS: Zorin OS 18 (Ubuntu 22.04 base)
- Desktop: GNOME/X11 or Wayland
- Qt: PyQt6
- Python: 3.10+

## Priority
Medium - Not blocking functionality, but significantly impacts UX

## Workaround
For now, users can:
- Click away from popup to return focus to previous window
- Deal with popup when ready (60s timeout)
- Popup won't disappear if clicked away
